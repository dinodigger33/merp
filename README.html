// game.js

// Basic Three.js setup
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Create player
const playerGeometry = new THREE.BoxGeometry(1, 1, 1);
const playerMaterial = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
const player = new THREE.Mesh(playerGeometry, playerMaterial);
scene.add(player);

// Create enemy
const enemyGeometry = new THREE.BoxGeometry(1, 1, 1);
const enemyMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
const enemy = new THREE.Mesh(enemyGeometry, enemyMaterial);
enemy.position.set(5, 0, 5);
scene.add(enemy);

// Camera positioning
camera.position.z = 10;

// Movement variables
let moveDirection = { left: false, right: false, up: false, down: false, jump: false };
let jumpVelocity = 0;

// Key event listeners for player movement
document.addEventListener('keydown', (event) => {
  if (event.key === 'ArrowUp') moveDirection.up = true;
  if (event.key === 'ArrowDown') moveDirection.down = true;
  if (event.key === 'ArrowLeft') moveDirection.left = true;
  if (event.key === 'ArrowRight') moveDirection.right = true;
  if (event.key === ' ') moveDirection.jump = true;
});

document.addEventListener('keyup', (event) => {
  if (event.key === 'ArrowUp') moveDirection.up = false;
  if (event.key === 'ArrowDown') moveDirection.down = false;
  if (event.key === 'ArrowLeft') moveDirection.left = false;
  if (event.key === 'ArrowRight') moveDirection.right = false;
  if (event.key === ' ') moveDirection.jump = false;
});

// Game loop
function animate() {
  requestAnimationFrame(animate);

  // Player movement
  if (moveDirection.up) player.position.z -= 0.1;
  if (moveDirection.down) player.position.z += 0.1;
  if (moveDirection.left) player.position.x -= 0.1;
  if (moveDirection.right) player.position.x += 0.1;

  // Jump logic
  if (moveDirection.jump && player.position.y <= 1) jumpVelocity = 0.2;
  player.position.y += jumpVelocity;
  if (player.position.y > 1) jumpVelocity -= 0.01; // Simulate gravity

  // Enemy follows player
  const dx = player.position.x - enemy.position.x;
  const dz = player.position.z - enemy.position.z;
  const distance = Math.sqrt(dx * dx + dz * dz);
  if (distance > 1) {
    enemy.position.x += (dx / distance) * 0.05;
    enemy.position.z += (dz / distance) * 0.05;
  }

  // Render scene
  renderer.render(scene, camera);
}
animate();
